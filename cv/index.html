<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daniel Serbu | CV - Penetration Tester & Security Researcher</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="show-scanlines">
    <nav>
        <div class="nav-container">
            <a href="/" class="logo">daniel_serbu</a>
            <button class="mobile-menu-btn" onclick="toggleMenu()">&#9776;</button>
            <ul class="nav-links" id="navLinks">
                <li><a href="/#about">About</a></li>
                <li><a href="/#links">Links</a></li>
                <li><a href="/#skills">Skills</a></li>
                <li><a href="/#certifications">Certs</a></li>
                <li><a href="/#experience">Experience</a></li>
                <li><a href="/#contact">Contact</a></li>
                <li><a href="/cv" style="color: var(--accent-green);">CV</a></li>
            </ul>
        </div>
    </nav>

    <div class="cv-page-wrapper">
        <div class="cv-page-header">
            <h1>Curriculum <span>Vitae</span></h1>
            <p>Professional CV ready for download. Click below to generate a PDF.</p>
            <div class="cv-actions">
                <button class="btn btn-primary" id="downloadBtn" onclick="downloadPDF()">Download PDF</button>
                <a href="/" class="btn btn-secondary">Back to Portfolio</a>
            </div>
        </div>

        <div class="cv-document">
            <div class="cv-content" id="cvContent">

                <div class="cv-header">
                    <div class="cv-name" id="cvName"></div>
                    <div class="cv-title" id="cvTitle"></div>
                    <div class="cv-contact-row" id="cvContactRow"></div>
                </div>

                <div class="cv-section">
                    <div class="cv-section-title">Professional Summary</div>
                    <div class="cv-summary-text" id="cvSummary"></div>
                </div>

                <div class="cv-section" id="cvExperience">
                    <div class="cv-section-title">Professional Experience</div>
                </div>

                <div class="cv-section" id="cvSkills">
                    <div class="cv-section-title">Technical Skills</div>
                    <table class="cv-skills-table" id="cvSkillsTable"></table>
                </div>

                <div class="cv-section" id="cvCertifications">
                    <div class="cv-section-title">Professional Certifications</div>
                    <table class="cv-certs-table" id="cvCertsTable"></table>
                </div>

                <div class="cv-section" id="cvEducation">
                    <div class="cv-section-title">Education</div>
                </div>

                <div class="cv-section" id="cvLanguages">
                    <div class="cv-section-title">Languages</div>
                    <div class="cv-langs-row" id="cvLangsRow"></div>
                </div>

            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2026 Daniel Serbu</p>
    </footer>

    <script>
        function toggleMenu() {
            document.getElementById('navLinks').classList.toggle('active');
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            let bgColor = '#00ff9d';
            if (type === 'error') bgColor = '#ff3e3e';
            if (type === 'info') bgColor = '#00d4ff';
            notification.style.cssText = `
                position: fixed; top: 100px; right: 20px;
                background: ${bgColor}; color: #0a0a0f;
                padding: 1rem 1.5rem; border-radius: 8px;
                font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;
                z-index: 10000; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, type === 'info' ? 5000 : 3000);
        }

        function addScaleCV() {
            document.body.classList.add('scale-cv');
        }

        function removeScaleCV() {
            document.body.classList.remove('scale-cv');
        }

        function generateResume() {
            const areaCV = document.getElementById('cvContent');
            let opt = {
                margin: 0,
                filename: 'Daniel_Serbu_CV.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 4, useCORS: true },
                jsPDF: { format: 'a4', orientation: 'portrait' }
            };
            html2pdf(areaCV, opt);
        }

        function downloadPDF() {
            showNotification('Generating PDF...', 'info');
            addScaleCV();
            generateResume();
            setTimeout(removeScaleCV, 2000);
            setTimeout(function() {
                showNotification('PDF downloaded successfully!');
            }, 2500);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        async function loadProfileData() {
            try {
                var response = await fetch('/profile-data.json', { cache: 'no-cache' });
                if (!response.ok) {
                    console.error('Failed to load profile data:', response.status);
                    return;
                }
                var data = await response.json();

                // Header
                var nameEl = document.getElementById('cvName');
                if (nameEl) nameEl.textContent = data.name ? data.name.toUpperCase() : '';

                var titleEl = document.getElementById('cvTitle');
                if (titleEl) titleEl.textContent = data.title || '';

                var contactRow = document.getElementById('cvContactRow');
                if (contactRow) {
                    var sep = '<span class="cv-contact-sep">&nbsp;|&nbsp;</span>';
                    var parts = [];
                    if (data.locationShort || data.location) parts.push(escapeHtml(data.locationShort || data.location));
                    if (data.email) parts.push('<a href="mailto:' + escapeHtml(data.email) + '">' + escapeHtml(data.email) + '</a>');
                    if (data.linkedin) parts.push('<a href="' + escapeHtml(data.linkedin) + '">' + escapeHtml(data.linkedinShort || 'LinkedIn') + '</a>');
                    if (data.github) parts.push('<a href="' + escapeHtml(data.github) + '">' + escapeHtml(data.githubShort || 'GitHub') + '</a>');
                    if (data.website) parts.push('<a href="https://' + escapeHtml(data.website) + '">' + escapeHtml(data.website) + '</a>');
                    contactRow.innerHTML = parts.join(sep);
                }

                // Summary
                var summaryEl = document.getElementById('cvSummary');
                if (summaryEl) summaryEl.textContent = data.cvSummary || data.summary || '';

                // Experience
                if (data.experience) {
                    var expSection = document.getElementById('cvExperience');
                    if (expSection) {
                        data.experience.forEach(function(exp) {
                            var dateRange = exp.current ? exp.startDate + ' - Present' : exp.startDate + ' - ' + exp.endDate;
                            var responsibilities = exp.responsibilities
                                .map(function(r) { return '<li>&#8226; ' + escapeHtml(r) + '</li>'; })
                                .join('');
                            var item = document.createElement('div');
                            item.className = 'cv-exp-item';
                            item.innerHTML =
                                '<div class="cv-exp-header">' +
                                    '<div class="cv-exp-role">' + escapeHtml(exp.title) + '</div>' +
                                    '<div class="cv-exp-date">' + escapeHtml(dateRange) + '</div>' +
                                '</div>' +
                                '<div class="cv-exp-company">' + escapeHtml(exp.company) + ' - ' + escapeHtml(exp.location) + '</div>' +
                                '<ul class="cv-exp-list">' + responsibilities + '</ul>';
                            expSection.appendChild(item);
                        });
                    }
                }

                // Skills
                if (data.skills) {
                    var skillsTable = document.getElementById('cvSkillsTable');
                    if (skillsTable) {
                        for (var i = 0; i < data.skills.length; i += 2) {
                            var row = document.createElement('tr');
                            var skill1 = data.skills[i];
                            var skill2 = data.skills[i + 1];
                            var label1 = skill1.cvCategory || skill1.category;
                            var value1 = (skill1.cvTags || skill1.tags).join(', ');
                            var cell1Html = '<td><span class="cv-skill-label">' + escapeHtml(label1) + ': </span><span class="cv-skill-value">' + escapeHtml(value1) + '</span></td>';
                            var cell2Html = '<td></td>';
                            if (skill2) {
                                var label2 = skill2.cvCategory || skill2.category;
                                var value2 = (skill2.cvTags || skill2.tags).join(', ');
                                cell2Html = '<td><span class="cv-skill-label">' + escapeHtml(label2) + ': </span><span class="cv-skill-value">' + escapeHtml(value2) + '</span></td>';
                            }
                            row.innerHTML = cell1Html + cell2Html;
                            skillsTable.appendChild(row);
                        }
                    }
                }

                // Certifications
                if (data.certifications) {
                    var certsTable = document.getElementById('cvCertsTable');
                    if (certsTable) {
                        for (var j = 0; j < data.certifications.length; j += 2) {
                            var certRow = document.createElement('tr');
                            var cert1 = data.certifications[j];
                            var cert2 = data.certifications[j + 1];
                            var certCell1 = '<td>&#8226; ' + escapeHtml(cert1.shortName) + ' - ' + escapeHtml(cert1.fullName) + ' <span class="cv-cert-issuer">(' + escapeHtml(cert1.issuer) + ')</span></td>';
                            var certCell2 = '<td></td>';
                            if (cert2) {
                                certCell2 = '<td>&#8226; ' + escapeHtml(cert2.shortName) + ' - ' + escapeHtml(cert2.fullName) + ' <span class="cv-cert-issuer">(' + escapeHtml(cert2.issuer) + ')</span></td>';
                            }
                            certRow.innerHTML = certCell1 + certCell2;
                            certsTable.appendChild(certRow);
                        }
                    }
                }

                // Education
                if (data.education) {
                    var eduSection = document.getElementById('cvEducation');
                    if (eduSection) {
                        data.education.forEach(function(edu) {
                            var eduDiv = document.createElement('div');
                            eduDiv.innerHTML =
                                '<div class="cv-edu-header">' +
                                    '<div class="cv-edu-degree">' + escapeHtml(edu.degree) + '</div>' +
                                    '<div class="cv-edu-year">' + escapeHtml(edu.startYear) + ' - ' + escapeHtml(edu.endYear) + '</div>' +
                                '</div>' +
                                '<div class="cv-edu-school">' + escapeHtml(edu.school) + '</div>';
                            eduSection.appendChild(eduDiv);
                        });
                    }
                }

                // Languages
                if (data.languages) {
                    var langsRow = document.getElementById('cvLangsRow');
                    if (langsRow) {
                        langsRow.innerHTML = data.languages
                            .map(function(lang) { return '<span class="cv-lang-name">' + escapeHtml(lang.name) + '</span> - <span class="cv-lang-level">' + escapeHtml(lang.level) + '</span>'; })
                            .join('&nbsp;&nbsp;&nbsp;&nbsp;');
                    }
                }

                console.log('CV profile data loaded successfully');
            } catch (error) {
                console.error('Error loading CV profile data:', error);
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadProfileData);
        } else {
            loadProfileData();
        }
    </script>
</body>
</html>
